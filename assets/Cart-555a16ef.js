import{_ as I,m as A,k as q,f as O,r,o as i,c as d,b as n,a as e,F as v,h as U,d as u,t as p,j as y,l as x,w as f,i as C,n as _}from"./index-f2981d1c.js";import{c as h}from"./cartStore-c0bac044.js";import{O as D}from"./OrderTimeLine-1dce5ac9.js";import{S as k}from"./sweetalert2.all-bee90c50.js";import{_ as j}from"./Property1_Variant8-7383cf9f.js";const{VITE_API:P,VITE_PATH:B}={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"wendybai",BASE_URL:"/ChuloveTravel/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},R={data(){return{isLoading:!1,fullPage:!0,color:"#ACB1E7",form:{user:{name:"",email:"",tel:"",address:""},message:""}}},components:{OrderTimeLine:D},computed:{...A(h,["cart","total","final_total","loadingStatus"]),...q(h,["coupon_code"])},methods:{...O(h,["getCart","removeCartItem","deleteAllCarts","updateCart","addCoupon"]),createOrder(){this.isLoading=!0;const o=this.form;this.$http.post(`${P}/api/${B}/order`,{data:o}).then(t=>{this.isLoading=!1;const{orderId:b}=t.data;console.log("createOrder 結帳",t),k.fire({icon:"success",title:t.data.message,showConfirmButton:!1,timer:1500}),this.$refs.form.resetForm(),this.$router.push(`/cart-complete/${b}`)}).catch(()=>{k.fire({icon:"error",title:"訂單送出失敗"})})}},mounted(){this.getCart()}},W={key:0},F={class:"cart container"},M={class:"container d-flex flex-column flex-lg-row align-items-start justify-content-center row gx-lg-6"},N={class:"orders-confirm col-lg-8"},z=e("h2",{class:"mb-5 mt-6 h2-style"},"確認訂單",-1),G={class:"orders mb-1"},H={class:"card card-row flex-row"},X=["src"],J={class:"card-body d-flex flex-column justify-content-between"},K={class:"card-title mb-2 pe-6"},Q={class:"d-flex flex-md-row flex-column justify-content-md-between align-items-md-center align-items-end"},Y={class:"count-icon input-group input-group-lg"},Z=["onClick","disabled"],$=e("i",{class:"fa-solid fa-circle-minus"},null,-1),ee=[$],se=["value"],te=["onClick","disabled"],oe=e("i",{class:"fa-solid fa-circle-plus"},null,-1),le=[oe],ne={class:"card-price card-price-title"},ae={class:"fs-6 d-flex flex-nowrap align-items-center"},re={class:"ps-2"},ie=["onClick"],de=e("i",{class:"bi bi-trash-fill"},null,-1),ce=[de],me={class:"text-end"},ue={class:"orders-total px-lg-3 pt-3 border-top"},pe=e("h3",null,"商品總額",-1),_e={class:"card-price fs-6"},fe={class:"ps-2"},he=e("h3",{class:"total-text-lh",style:{width:"120px"}},"折扣碼",-1),be={class:"input-group orders-coupon justify-content-end align-items-center"},ge=e("h3",null,"總計",-1),ve={class:"card-price text-danger text-end fs-6"},ye={class:"ps-2"},xe={class:"pt-7 mb-7"},Ce=e("h3",null,"❮ 繼續購物",-1),ke={class:"orders-form col-lg-4"},Ve=e("h2",{class:"mb-5 mt-6 h2-style"},"收件資料",-1),we={class:"orders px-0 mx-0"},Te={class:"mb-3"},Le=e("label",{for:"name",class:"form-label"},"收件人姓名",-1),Se={class:"mb-3"},Ee=e("label",{for:"tel",class:"form-label"},"收件人電話",-1),Ie={class:"mb-3"},Ae=e("label",{for:"address",class:"form-label"},"收件人地址",-1),qe={class:"mb-3"},Oe=e("label",{for:"email",class:"form-label"},"Email",-1),Ue={class:"mb-3"},De=e("label",{for:"message",class:"form-label"},"訂單備註",-1),je=e("div",{class:"text-end"},[e("button",{type:"submit",class:"btn btn-danger px-lg-5 px-4"}," 送出訂單 ")],-1),Pe={key:1,class:"d-flex flex-column justify-content-center align-items-center p-5"},Be=e("h2",{class:"mt-7 text-center"},"目前購物車內無商品！ 請盡情挑選喔～",-1),Re=e("img",{src:j,alt:"cart",width:"100",class:"mt-3"},null,-1);function We(o,t,b,Fe,l,V){var g;const w=r("VueLoading"),T=r("OrderTimeLine"),L=r("router-link"),c=r("v-field"),m=r("error-message"),S=r("v-form"),E=r("RouterLink");return i(),d(v,null,[n(w,{active:l.isLoading,"onUpdate:active":t[0]||(t[0]=s=>l.isLoading=s),color:l.color,"is-full-page":l.fullPage},null,8,["active","color","is-full-page"]),(g=o.cart.carts)!=null&&g.length?(i(),d("div",W,[e("div",F,[n(T),e("div",M,[e("div",N,[z,e("ul",G,[(i(!0),d(v,null,U(o.cart.carts,s=>(i(),d("li",{class:"mb-3",key:s.id},[e("div",H,[e("img",{class:"card-row-img object-cover orders-img",src:s.product.imageUrl,alt:"Xpark"},null,8,X),e("div",J,[e("h2",K,p(s.product.title),1),e("div",Q,[e("div",Y,[e("button",{type:"button",onClick:C(a=>o.updateCart(s,s.qty-1),["prevent"]),class:"count-btn border-0 bg-transparent p-0 pe-1",disabled:o.loadingStatus.loadingItem||s.qty===1},ee,8,Z),e("input",{type:"text",class:"form-control border-0 text-center shadow-none px-0 pe-1",placeholder:"","aria-label":"Example text with button addon","aria-describedby":"button-addon1 inputGroup-sizing-lg",readonly:"",value:s.qty},null,8,se),e("button",{type:"button",onClick:C(a=>o.updateCart(s,s.qty+1),["prevent"]),class:"count-btn border-0 bg-transparent p-0 ps-1",disabled:o.loadingStatus.loadingItem||s.qty===20},le,8,te)]),e("div",ne,[e("p",ae,[u(" TWD "),e("span",re,p(s.total),1)])])]),e("button",{type:"button",onClick:a=>o.removeCartItem(s.id),class:"orders-del border-0 p-0"},ce,8,ie)])])]))),128))]),e("div",me,[e("button",{class:"btn btn-outline-danger mb-lg-7 mb-5",type:"button",onClick:t[1]||(t[1]=(...s)=>o.deleteAllCarts&&o.deleteAllCarts(...s))}," 清空購物車 ")]),e("ul",ue,[e("li",null,[pe,e("p",_e,[u(" TWD "),e("span",fe,p(o.total),1)])]),e("li",null,[he,e("div",be,[y(e("input",{type:"text",name:"coupon",class:"form-control","onUpdate:modelValue":t[2]||(t[2]=s=>o.coupon_code=s),placeholder:"請輸入折扣碼"},null,512),[[x,o.coupon_code]]),e("button",{class:"btn btn-primary",style:{height:"40px"},type:"button",onClick:t[3]||(t[3]=s=>o.addCoupon(o.coupon_code))}," 確認 ")])]),e("li",null,[ge,e("p",ve,[u(" TWD "),e("span",ye,p(o.final_total),1)])]),e("li",xe,[n(L,{class:"darkgary",to:"/products-list"},{default:f(()=>[Ce]),_:1})])])]),e("div",ke,[Ve,e("div",we,[n(S,{ref:"form",onSubmit:V.createOrder},{default:f(({errors:s})=>[e("div",Te,[Le,n(c,{id:"name",name:"姓名",type:"text",class:_(["form-control",{"is-invalid":s.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:l.form.user.name,"onUpdate:modelValue":t[4]||(t[4]=a=>l.form.user.name=a)},null,8,["class","modelValue"]),n(m,{name:"姓名",class:"invalid-feedback"})]),e("div",Se,[Ee,n(c,{id:"tel",name:"電話",type:"text",class:_(["form-control",{"is-invalid":s.電話}]),placeholder:"請輸入電話",rules:"required|min:8|max:10",modelValue:l.form.user.tel,"onUpdate:modelValue":t[5]||(t[5]=a=>l.form.user.tel=a)},null,8,["class","modelValue"]),n(m,{name:"電話",class:"invalid-feedback"})]),e("div",Ie,[Ae,n(c,{id:"address",name:"地址",type:"text",class:_(["form-control",{"is-invalid":s.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:l.form.user.address,"onUpdate:modelValue":t[6]||(t[6]=a=>l.form.user.address=a)},null,8,["class","modelValue"]),n(m,{name:"地址",class:"invalid-feedback"})]),e("div",qe,[Oe,n(c,{id:"email",name:"email",type:"email",class:_(["form-control",{"is-invalid":s.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:l.form.user.email,"onUpdate:modelValue":t[7]||(t[7]=a=>l.form.user.email=a)},null,8,["class","modelValue"]),n(m,{name:"email",class:"invalid-feedback"})]),e("div",Ue,[De,y(e("textarea",{id:"message",class:"form-control",cols:"30",rows:"5","onUpdate:modelValue":t[8]||(t[8]=a=>l.form.message=a)},null,512),[[x,l.form.message]])]),je]),_:1},8,["onSubmit"])])])])])])):(i(),d("div",Pe,[Be,Re,n(E,{class:"btn btn-primary mt-3 px-4",to:"/products-list"},{default:f(()=>[u(" 出發Go ")]),_:1})]))],64)}const Xe=I(R,[["render",We]]);export{Xe as default};
